<h2>Registro de Modelos</h2>

<div [formGroup]="modelForm">
  <div class="row">
    <!-- Nombre -->
    <div class="col-sm-4">
      <div class="mb-3">
        <label for="nombre" class="form-label">Nombre del modelo</label>
        <input
          type="text"
          class="form-control"
          formControlName="nombre"
          id="nombre"
          [ngClass]="{
            'is-invalid': fc['nombre'].invalid && (fc['nombre'].touched || submitted)
          }"
        />

        @if (fc['nombre'].hasError('required')) {
          <div class="invalid-feedback">El nombre es requerido.</div>
        }
        @if (fc['nombre'].hasError('minlength')) {
          <div class="invalid-feedback">
            El nombre debe tener mínimo {{
              fc['nombre'].errors?.['minlength']?.requiredLength
            }} caracteres.
          </div>
        }
        @if (fc['nombre'].hasError('maxlength')) {
          <div class="invalid-feedback">
            El nombre debe tener como máximo {{
              fc['nombre'].errors?.['maxlength']?.requiredLength
            }} caracteres.
          </div>
        }
      </div>
    </div>

    <!-- Marca -->
<div class="col-sm-4">
  <div class="mb-3">
    <label for="marcaId" class="form-label">Marca</label>
    <select
      id="marcaId"
      class="form-select"
      formControlName="marcaId"
      [ngClass]="{
        'is-invalid':
          fc['marcaId'].invalid &&
          (fc['marcaId'].touched || submitted)
      }"
    >
      <option value="">Seleccione una marca</option>
      @for (brand of brands; track brand.idMarca) {
        <option [value]="brand.idMarca">{{ brand.nombre }}</option>
      }
    </select>

    @if (fc['marcaId'].hasError('required')) {
      <div class="invalid-feedback">
        La marca es requerida.
      </div>
    }
  </div>
</div>


  <!-- Descripción -->
  <div class="row">
    <div class="col-sm-8">
      <div class="mb-3">
        <label for="descripcion" class="form-label">Descripción</label>
        <textarea
          class="form-control"
          formControlName="descripcion"
          id="descripcion"
          rows="3"
          [ngClass]="{
            'is-invalid': fc['descripcion'].invalid && (fc['descripcion'].touched || submitted)
          }"
        ></textarea>

        @if (fc['descripcion'].hasError('maxlength')) {
          <div class="invalid-feedback">
            La descripción debe tener como máximo {{
              fc['descripcion'].errors?.['maxlength']?.requiredLength
            }} caracteres.
          </div>
        }
      </div>
    </div>
  </div>

  <!-- Año lanzamiento / Versión / Capacidad pasajeros -->
  <div class="row">
    <!-- Año de lanzamiento -->
    <div class="col-sm-4">
      <div class="mb-3">
        <label for="anioLanzamiento" class="form-label">Año de lanzamiento</label>
        <input
          type="text"
          id="anioLanzamiento"
          class="form-control sin-flechas"
          formControlName="anioLanzamiento"
          maxlength="4"
          placeholder="Ej. 2024"
          [ngClass]="{
            'is-invalid':
              fc['anioLanzamiento'].invalid &&
              (fc['anioLanzamiento'].touched || submitted)
          }"
        />

        @if (fc['anioLanzamiento'].hasError('min')) {
          <div class="invalid-feedback">El año mínimo permitido es 1900.</div>
        }
        @if (fc['anioLanzamiento'].hasError('max')) {
          <div class="invalid-feedback">El año máximo permitido es 2100.</div>
        }
        @if (fc['anioLanzamiento'].hasError('pattern')) {
          <div class="invalid-feedback">Ingrese un año válido de 4 dígitos.</div>
        }
      </div>
    </div>

    <!-- Versión -->
    <div class="col-sm-4">
      <div class="mb-3">
        <label for="version" class="form-label">Versión</label>
        <input
          type="text"
          class="form-control"
          formControlName="version"
          id="version"
          placeholder="Ej. SE Hybrid"
          [ngClass]="{
            'is-invalid':
              fc['version'].invalid && (fc['version'].touched || submitted)
          }"
        />

        @if (fc['version'].hasError('maxlength')) {
          <div class="invalid-feedback">
            La versión debe tener como máximo {{
              fc['version'].errors?.['maxlength']?.requiredLength
            }} caracteres.
          </div>
        }
      </div>
    </div>

    <!-- Capacidad de pasajeros -->
    <div class="col-sm-4">
      <div class="mb-3">
        <label for="capacidadPasajeros" class="form-label">Capacidad de pasajeros</label>
        <input
          type="number"
          id="capacidadPasajeros"
          class="form-control sin-flechas"
          formControlName="capacidadPasajeros"
          min="1"
          max="9"
          placeholder="Ej. 5"
          [ngClass]="{
            'is-invalid':
              fc['capacidadPasajeros'].invalid &&
              (fc['capacidadPasajeros'].touched || submitted)
          }"
        />

        @if (fc['capacidadPasajeros'].hasError('min')) {
          <div class="invalid-feedback">La capacidad mínima es 1 pasajero.</div>
        }
        @if (fc['capacidadPasajeros'].hasError('max')) {
          <div class="invalid-feedback">La capacidad máxima es 9 pasajeros.</div>
        }
        @if (fc['capacidadPasajeros'].hasError('pattern')) {
          <div class="invalid-feedback">Ingrese solo números válidos.</div>
        }
      </div>
    </div>
  </div>

  <!-- Botones -->
  <div class="row">
    <div class="col-sm-8">
      <button type="button" class="btn btn-primary me-2" (click)="save()">
        Grabar
      </button>
      <button type="button" class="btn btn-secondary" (click)="cancelar()">
        Cancelar
      </button>
    </div>
  </div>
</div>
